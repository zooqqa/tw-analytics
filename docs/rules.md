# Правила реализации и работы с ИИ

Документ фиксирует обязательные правила, которым должно следовать ИИ и команда разработки при реализации проекта. Цель — избегать упрощений, неполных решений и отклонений от согласованных требований.

## 1. Общие правила

1. Все задачи выполняются строго по планам `docs/mvp_plan.md` и `docs/features_plan.md`. Любые изменения — только после согласования и обновления документации.
2. Нельзя удалять или упрощать требования из `docs/requirements.md` без явного решения заказчика.
3. Каждый коммит/изменение должен сопровождаться обновлением соответствующих документов (архитектура, требования, планы) при необходимости.
4. Оригинальные CSV и данные всегда сохраняются. Запрещено перезаписывать без сохранения копии.
5. Формулы метрик и структура данных не меняются без документации и ревью.

## 2. Работа с данными

1. Все таблицы и поля из источников хранятся с префиксами (`tw_`, `m_`).
2. Любые новые поля должны быть задокументированы (описание, формула, источник).
3. Валидация данных обязательна: при ошибках загрузка не продвигается дальше, лог сохраняется.
4. Перерасчёты витрин должны учитывать историю (`load_id`, `source_file`).
5. Никакие данные не удаляются без соответствующего `archive` флага и истории.

## 3. Пользовательский интерфейс

1. Фильтр реализуется одной кнопкой с попапом, как описано в `docs/mvp_plan.md`.
2. Все фильтры поддерживают пресеты и загрузку/сохранение настроек.
3. UI обязан отображать полные данные, без «скрытия» колонок ради упрощения.
4. Улучшения UI (цвета, графики) не должны скрывать исходные цифры.

## 4. Автоматизация и алерты

1. Пороговые значения и правила хранятся в конфигурации или БД, а не в коде.
2. Каждое автоматическое действие логируется и может быть отменено.
3. Алерты не удаляются: только обозначение состояния (решён/активен).
4. ML/AI рекомендации не заменяют решение человека; итоговое действие — за ответственным пользователем.

## 5. Работа с ИИ (ChatGPT, Copilot и т.д.)

1. ИИ используется как ассистент, но не единственный источник истины.
2. Результаты ИИ всегда проверяются и соотносятся с требованиями.
3. Запрещено внедрять «упрощённые» решения, предложенные ИИ, если они нарушают планы и требования.
4. При разногласиях между предложениями ИИ и документацией приоритет у документации.
5. Любые нестандартные идеи от ИИ должны быть вынесены на отдельное обсуждение и задокументированы.

## 6. Контроль качества

1. Тесты (unit, integration) обязательны для новых модулей.
2. Линтеры, форматирование и проверки проходят до merge.
3. Любой фейл ETL/алерта расследуется: причина фиксируется в issue и runbook.
4. Регулярные ревью архитектуры и требований (не реже одного раза в спринт) для синхронизации документации.

## 7. Коммуникация

1. Все изменения обсуждаются в письменном виде (issue, PR, документ) до реализации.
2. Любые изменения требований фиксируются в `docs/idea.md` или отдельном RFC.
3. Запрещено пропускать этапы плана ради скорости (например, внедрять офферы без витрины данные).
4. Вопросы и неопределённости должны быть подняты до начала работы над задачей.

---

Следование этим правилам — обязательное условие для успешной реализации проекта. Любое отклонение согласовывается заранее и фиксируется в документации.

